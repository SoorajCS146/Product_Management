<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Manage Products</title>
        <link rel="stylesheet" href="../Styles/styles.css">
    </head>
    <body>
        <div class="products-container container">
            <h2>Product Inventory</h2>
            <div class="buttonsContainer">
                <button class="viewProductsButton">View Products</button>
                <button class="addProductButton">Add Product</button>
                <button onclick="alert('Dummy Placeholder Button!');">Dummy2</button>
            </div>
            <div class="diplayContainer">

            </div>
        </div>

    </body>

    <script type="module">
        import "../Components/AddProductComponent.js";
        import "../Components/ViewProductsComponent.js";
        const productDisplayContainer = document.querySelector(".diplayContainer");

        const viewProductsButton = document.querySelector(".viewProductsButton");
        const addProductButton = document.querySelector(".addProductButton");

        viewProductsButton.addEventListener("click", async (event) => {
            event.stopPropagation();
            let productList;
            try {
                const response = await fetch("http://localhost:3000/products", { // âœ… Use correct route
                    method: "GET",
                    headers: { "Content-Type": "application/json" },
                });

                
                if(response.ok)
                {
                    const result = await response.json();
                    productList=result.data;
                }
                else{
                    productList="No Products found";
                }
                
            } catch (error) {

                alert("Error fetching  Product");
                console.error(error);
            }


            const viewProductsPopup = document.createElement("view-products-component");
            viewProductsPopup.initialize(productList);
            viewProductsPopup.style.position = "fixed";
            viewProductsPopup.style.left = "50%";
            viewProductsPopup.style.top = "50%";
            viewProductsPopup.style.transform = "translate(-50%, -50%)";
            viewProductsPopup.style.height="90%";
            viewProductsPopup.style.width="90%";
            document.body.onclick = () => {
                document.querySelectorAll("view-products-component").forEach((element) => {
                    element.remove();
                });
            };

            document.body.appendChild(viewProductsPopup);
        });


        addProductButton.addEventListener("click", (event) => {
            event.stopPropagation();
            console.log("Add-Product-Button Clicked!"); 
            
            const addProductPopup = document.createElement("add-product-component");

            addProductPopup.style.position = "fixed";
            addProductPopup.style.left = "50%";
            addProductPopup.style.top = "50%";
            addProductPopup.style.transform = "translate(-50%, 50%)";

            document.body.onclick = () => {
                document.querySelectorAll("add-product-component").forEach((element) => {
                    element.remove();
                });
            };

            document.body.appendChild(addProductPopup);

        });
    
    </script>

</html>